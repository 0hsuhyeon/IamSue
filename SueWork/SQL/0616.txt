--01 이름과 봉급 
SELECT ENAME, SAL
FROM EMP; 

--02 
SELECT * from Emp;

--EMPNO: 사원번호, ENAME: 사원명, JOB: 직급, MGR: 관리자번호, HIREDATE: 입사일, SAL: 봉급, COMM: 보너스, DEPTNO:부서번호
--03 
SELECT ENAME, DEPTNO FROM EMP WHERE DEPTNO = 10;

--04 20번 30번 부서의 사원명 부서번호 봉급
SELECT ENAME,DEPTNO,SAL FROM EMP WHERE DEPTNO in(20,30);
SELECT ENAME,DEPTNO,SAL FROM EMP WHERE DEPTNO =30 OR DEPTNO=20;

--05 입사일이 1981년인 사원들의 사원명과 입사일 관리자 번호 
SELECT ENAME,HIREDATE,MGR FROM EMP WHERE TO_CHAR(HIREDATE,'YYYY') = '1981'; -- BEST
SELECT ENAME,HIREDATE,MGR FROM EMP WHERE HIREDATE LIKE '81%'; --81%로 출력이안되면 1981%로 검색하기
SELECT ENAME,HIREDATE,MGR FROM EMP WHERE HIREDATE >='1981/01/01' AND HIREDATE <='1981/12/31';

--06 DEPT테이블 확인하기 
SELECT * FROM DEPT;
--DEPTNO: 부서번호, DNAME: 부서명, LOC: 부서위치 

--07 SALGRADE 테이블 확인
SELECT * FROM SALGRADE;
--GRADE: 등급 , LOSAL: 등급 내 최하위봉급, HISAL: 등급 내 최고봉급

--08 20번 부서의 부서번호, 부서명
SELECT DEPTNO, DNAME FROM DEPT WHERE DEPTNO=20;

--09 등급이 1등급중 최하위 급여와 최고급여
SELECT GRADE, LOSAL, HISAL FROM SALGRADE WHERE GRADE=1;

--10 봉급이 3000대인 사람 
SELECT ENAME, SAL FROM EMP WHERE SAL LIKE '3%';
SELECT ENAME, SAL FROM EMP WHERE SAL > 2999 AND SAL < 4000;

--11 부서명이 SALES인 부서의 위치 출력
SELECT * FROM DEPT WHERE DNAME = 'SALES'; -- 문자열인 경우 앞뒤에 작은따옴표

--12 10번 부서의 위치
SELECT LOC FROM DEPT WHERE DEPTNO = 10;

--13 10번 부서의 사원명과 부서번호
SELECT ENAME,DEPTNO FROM EMP WHERE DEPTNO=10;

--14 10번 부서의 사원명과 부서번호, 부서명
SELECT EMP.ENAME,EMP.DEPTNO,DEPT.DNAME FROM EMP,DEPT -- 중복되는 행은 소속테이블을 정확하게 말해줘야 함 
WHERE EMP.DEPTNO = DEPT.DEPTNO AND DEPT.DEPTNO=10; -- 등가조인: 두 테이블에 같은 열이 있을 때

--15 사원수
SELECT COUNT(*)
FROM EMP;

--16 부서수
SELECT COUNT(*)
FROM DEPT;

--17 10번 부서에 속한 사원번호, 봉급, 부서명, 부서위치
SELECT EMPNO,DNAME,LOC FROM EMP E,DEPT D
WHERE E.DEPTNO = D.DEPTNO AND D.DEPTNO=10; 

--18 사원번호, 사원명, 봉급, 등급
SELECT EMPNO, ENAME, SAL, GRADE
FROM EMP E, SALGRADE S 
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL; -- 비등가조인: 급여범위를 지정하는 조건식으로 조인


--19 사원번호, 사원명, 부서번호, 부서명, 등급
SELECT E.EMPNO, E.ENAME, E.DEPTNO, D.DNAME, S.GRADE
FROM EMP E, SALGRADE S, DEPT D
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL AND E.DEPTNO = D.DEPTNO
ORDER BY E.EMPNO; 

--20 사원의 정보와 그 사원에 대한 부서정보를 사원번호 순으로 검색
SELECT * 
FROM EMP E,DEPT D
WHERE E.DEPTNO = D.DEPTNO
ORDER BY E.EMPNO;

--21 사원번호, 사원명, 부서번호, 부서명, 위치를 부서번호, 사원번호 순으로 검색
SELECT  E.EMPNO, E.ENAME, E.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
ORDER BY D.DEPTNO,E.EMPNO;

--22 급여가 3000이상인 사원들의 사원번호, 사원명, 봉급, 부서번호, 부서명, 위치
SELECT E.EMPNO, E.ENAME, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO AND SAL BETWEEN 3000 AND 4000;

--23 모든 사원들의 정보와 급여 등급정보를 출력
SELECT *
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;

--24 사원들의 사원번호, 사원명, 관리자번호
SELECT EMPNO, ENAME, MGR FROM EMP;

--25 사원들의 사원번호, 사원명, 관리자번호, 관리자 이름
SELECT E1.EMPNO,E1.ENAME,E1.MGR, E2.ENAME AS MGR_ENAME
FROM EMP E1, EMP E2 
WHERE E1.MGR = E2.EMPNO;


--26번 사원번호 이름 관리자번호 관리자의 사원번호 관리자 이름을 사원번호 순으로 출력 단 관리자가 없는 사원도 나오게
SELECT E1.EMPNO,E1.ENAME,E1.MGR, E2.ENAME AS MGR_ENAME
FROM EMP E1, EMP E2 
WHERE E1.MGR = E2.EMPNO(+) -- 왼쪽 외부조인
ORDER BY E1.EMPNO;

--27번 번외 오른쪽 외부 조인 
SELECT E1.EMPNO,E1.ENAME,E1.MGR, E2.ENAME AS MGR_ENAME
FROM EMP E1, EMP E2 
WHERE E1.MGR(+) = E2.EMPNO
ORDER BY E1.EMPNO;

--28번 사원번호, 사원명, 직급, 관리자번호, 입사일, 급여, 보너스, 부서번호, 부서명, 위치, 부서번호와 사원번호순으로 정렬 (FROM EMP E NATURAL JOIN DEPT D)
SELECT *
FROM EMP E NATURAL JOIN DEPT D
ORDER BY DEPTNO,E.EMPNO;

--29번 사원번호, 사원명, 직급, 관리자번호, 입사일, 급여, 보너스, 부서번호, 부서명, 위치, 급여가 3000이상인 사원들 대상 부서번호와 사원번호순으로 정렬(FROM EMP E JOIN DEPT D USING(DEPTNO)
SELECT *
FROM EMP E JOIN DEPT D USING(DEPTNO)
WHERE SAL >=3000
ORDER BY DEPTNO,E.EMPNO;

--30 FROM EMP E JOIN DEPT D ON (E.DEPTNO = D.DEPTNO)
SELECT *
FROM EMP E JOIN DEPT D ON (E.DEPTNO = D.DEPTNO)
WHERE SAL >=3000
ORDER BY D.DEPTNO,E.EMPNO;

--239쪽 문제1 
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO AND E.SAL > 2000
ORDER BY D.DEPTNO;